# æ™ºèƒ½å¯¹è¯ä¸å®¢æœç³»ç»Ÿ

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäºSpring Boot + Vue.jsçš„æ™ºèƒ½å¯¹è¯ä¸å®¢æœç³»ç»Ÿï¼Œä¸“ä¸ºæ™ºèƒ½å®¢æœåœºæ™¯è®¾è®¡ã€‚ç³»ç»Ÿé›†æˆäº†é˜¿é‡Œå·´å·´é€šä¹‰å¤§æ¨¡å‹ï¼Œæä¾›æ™ºèƒ½é—®ç­”ã€äº§å“æ¨èã€é¢„çº¦ç®¡ç†ç­‰åŠŸèƒ½ï¼Œæ”¯æŒæµå¼å¯¹è¯å’Œå‘é‡æ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)æŠ€æœ¯ã€‚

## æ ¸å¿ƒåŠŸèƒ½

### ğŸ¤– æ™ºèƒ½å¯¹è¯
- **æµå¼å¯¹è¯**: æ”¯æŒServer-Sent Events(SSE)å®æ—¶æµå¼å“åº”
- **ä¸Šä¸‹æ–‡è®°å¿†**: ç»´æŠ¤å¤šè½®å¯¹è¯å†å²ï¼Œä¿æŒå¯¹è¯è¿è´¯æ€§
- **RAGå¢å¼º**: åŸºäºå‘é‡æ£€ç´¢çš„çŸ¥è¯†åº“é—®ç­”ï¼Œæä¾›å‡†ç¡®çš„äº§å“ä¿¡æ¯

### ğŸ“‹ äº§å“ç®¡ç†
- **äº§å“å±•ç¤º**: å±•ç¤ºå„ç±»æ™ºèƒ½å®¢æœè§£å†³æ–¹æ¡ˆäº§å“
- **æ™ºèƒ½æ¨è**: æ ¹æ®ç”¨æˆ·éœ€æ±‚æ™ºèƒ½æ¨èç›¸å…³äº§å“
- **é¢„çº¦åŠŸèƒ½**: æ”¯æŒäº§å“é¢„çº¦å’Œå’¨è¯¢æäº¤

### ğŸ—ƒï¸ æ•°æ®ç®¡ç†
- **è”ç³»è¡¨å•**: æ”¶é›†ç”¨æˆ·å’¨è¯¢å’Œåˆä½œæ„å‘
- **çŠ¶æ€è·Ÿè¸ª**: è·Ÿè¸ªå’¨è¯¢å¤„ç†çŠ¶æ€(å¾…å¤„ç†/å·²è”ç³»/å·²æŠ¥ä»·/å·²ç­¾çº¦/å·²å¿½ç•¥)
- **ç”¨æˆ·ç®¡ç†**: ç®¡ç†ç”¨æˆ·ä¿¡æ¯å’Œæƒé™

## æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Spring Boot 3.2.4
- **AIé›†æˆ**: Spring AI Alibaba (é€šä¹‰å¤§æ¨¡å‹)
- **æ•°æ®åº“**: MySQL 8.0 + MyBatis 3.0.3
- **å‘é‡å­˜å‚¨**: æœ¬åœ°JSONå‘é‡å­˜å‚¨
- **æ„å»ºå·¥å…·**: Maven

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Vue 3.5.27 + TypeScript
- **UIç»„ä»¶**: Element Plus 2.13.1
- **æ„å»ºå·¥å…·**: Vite 7.2.4
- **Markdownæ¸²æŸ“**: Marked 17.0.1

### AIæ¨¡å‹é…ç½®
- **å¯¹è¯æ¨¡å‹**: glm-4.7 (é€šä¹‰åƒé—®)
- **åµŒå…¥æ¨¡å‹**: text-embedding-v1
- **æ¸©åº¦å‚æ•°**: 0.7 (å¹³è¡¡åˆ›é€ æ€§å’Œå‡†ç¡®æ€§)

## é¡¹ç›®ç»“æ„

```
æ™ºèƒ½å¯¹è¯ä¸å®¢æœç³»ç»Ÿ/
â”œâ”€â”€ backend/                    # Spring Bootåç«¯
â”‚   â”œâ”€â”€ src/main/java/com/smartcity/chat/
â”‚   â”‚   â”œâ”€â”€ config/           # é…ç½®ç±»
â”‚   â”‚   â”œâ”€â”€ controller/       # RESTæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ function/         # AIå‡½æ•°å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ mapper/           # MyBatisæ˜ å°„å™¨
â”‚   â”‚   â”œâ”€â”€ model/            # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ service/          # ä¸šåŠ¡æœåŠ¡
â”‚   â””â”€â”€ src/main/resources/
â”‚       â””â”€â”€ application.yml   # åº”ç”¨é…ç½®
â”œâ”€â”€ frontend/                   # Vue.jså‰ç«¯
â”‚   â”œâ”€â”€ src/components/       # Vueç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatWindow.vue    # èŠå¤©ä¸»çª—å£
â”‚   â”‚   â””â”€â”€ AppointmentCard.vue # é¢„çº¦å¡ç‰‡
â”‚   â””â”€â”€ package.json          # å‰ç«¯ä¾èµ–
â”œâ”€â”€ data/
â”‚   â””â”€â”€ vector_store.json     # å‘é‡å­˜å‚¨æ•°æ®
â””â”€â”€ cloud_smart_city.sql      # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Java 17+
- Node.js 18+
- MySQL 8.0+
- Maven 3.6+

### åç«¯é…ç½®

1. **æ•°æ®åº“é…ç½®**
   ```yaml
   spring:
     datasource:
       url: jdbc:mysql://localhost:3306/cloud_smart_city?useUnicode=true&characterEncoding=utf-8&useSSL=false
       username: root
       password: your_password
   ```

2. **AI APIé…ç½®**
   ```yaml
   ai:
     dashscope:
       api-key: ${AI_API_KEY:your_api_key}
   ```

3. **å¯åŠ¨åº”ç”¨**
   ```bash
   cd backend
   mvn spring-boot:run
   ```

### å‰ç«¯é…ç½®

1. **å®‰è£…ä¾èµ–**
   ```bash
   cd frontend
   npm install
   ```

2. **å¼€å‘æ¨¡å¼å¯åŠ¨**
   ```bash
   npm run dev
   ```

3. **ç”Ÿäº§æ„å»º**
   ```bash
   npm run build
   ```

## APIæ¥å£

### å¯¹è¯æ¥å£
- **POST** `/api/chat/stream`
- **Content-Type**: `text/event-stream`
- **è¯·æ±‚ä½“**:
  ```json
  {
    "message": "ç”¨æˆ·æ¶ˆæ¯",
    "history": [
      {"role": "user", "content": "å†å²æ¶ˆæ¯"},
      {"role": "assistant", "content": "å†å²å›å¤"}
    ]
  }
  ```

### è”ç³»è¡¨å•æ¥å£
- **POST** `/api/contact/submit`
- **GET** `/api/contact/list`
- **PUT** `/api/contact/update-status`

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

#### contact_submissions (è”ç³»æäº¤è¡¨)
| å­—æ®µ | ç±»å‹ | æè¿° |
|------|------|------|
| id | INT | ä¸»é”®ID |
| user_name | VARCHAR(100) | ç”¨æˆ·å |
| project_name | VARCHAR(200) | é¡¹ç›®å |
| project_description | VARCHAR(500) | é¡¹ç›®æè¿° |
| handle_status | VARCHAR(50) | å¤„ç†çŠ¶æ€ |
| user_id | VARCHAR(64) | ç”¨æˆ·ID |
| phonenumber | VARCHAR(50) | æ‰‹æœºå· |
| company | VARCHAR(50) | å…¬å¸å |
| entry_type | VARCHAR(50) | å…¥å£ç±»å‹ |

## æ ¸å¿ƒç‰¹æ€§è¯¦è§£

### RAGçŸ¥è¯†æ£€ç´¢
ç³»ç»Ÿé‡‡ç”¨å‘é‡ç›¸ä¼¼åº¦æ£€ç´¢æŠ€æœ¯ï¼Œå°†äº§å“ä¿¡æ¯è½¬æ¢ä¸ºå‘é‡å­˜å‚¨ï¼Œåœ¨ç”¨æˆ·æé—®æ—¶ï¼š
1. å°†ç”¨æˆ·é—®é¢˜è½¬æ¢ä¸ºå‘é‡
2. åœ¨å‘é‡åº“ä¸­æ£€ç´¢æœ€ç›¸ä¼¼çš„äº§å“ä¿¡æ¯
3. å°†æ£€ç´¢ç»“æœä½œä¸ºä¸Šä¸‹æ–‡æä¾›ç»™AIæ¨¡å‹
4. ç”ŸæˆåŸºäºçœŸå®äº§å“ä¿¡æ¯çš„å‡†ç¡®å›ç­”

### æµå¼å¯¹è¯å®ç°
ä½¿ç”¨Spring WebFluxå’ŒServer-Sent Eventså®ç°ï¼š
- å®æ—¶é€å­—å“åº”ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- æ”¯æŒé•¿æ–‡æœ¬çš„æµå¼ä¼ è¾“
- è‡ªåŠ¨å¤„ç†è¿æ¥ä¸­æ–­å’Œé‡è¿

### æ™ºèƒ½äº§å“æ¨è
ç³»ç»Ÿèƒ½å¤Ÿï¼š
- ç†è§£ç”¨æˆ·ä¸šåŠ¡éœ€æ±‚
- åŒ¹é…é€‚åˆçš„æ™ºèƒ½å®¢æœäº§å“
- æä¾›è¯¦ç»†çš„äº§å“ä»‹ç»å’Œæ¼”ç¤ºé“¾æ¥
- å¼•å¯¼ç”¨æˆ·è¿›è¡Œé¢„çº¦å’¨è¯¢

## é…ç½®è¯´æ˜

### åº”ç”¨é…ç½® (application.yml)
```yaml
server:
  port: 8080

spring:
  application:
    name: smart-chat-backend
  datasource:
    # æ•°æ®åº“è¿æ¥é…ç½®
  ai:
    dashscope:
      # AIæ¨¡å‹é…ç½®

smart-chat:
  vector-store:
    path: ./data/vector_store.json  # å‘é‡å­˜å‚¨è·¯å¾„
```

### å‰ç«¯é…ç½® (vite.config.js)
```javascript
export default {
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true
      }
    }
  }
}
```

## éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
1. **åç«¯æ‰“åŒ…**: `mvn clean package`
2. **å‰ç«¯æ„å»º**: `npm run build`
3. **æ•°æ®åº“åˆå§‹åŒ–**: æ‰§è¡Œ `cloud_smart_city.sql`
4. **é…ç½®ç¯å¢ƒå˜é‡**: è®¾ç½® `AI_API_KEY` ç­‰æ•æ„Ÿä¿¡æ¯
5. **å¯åŠ¨æœåŠ¡**: ä½¿ç”¨ `java -jar` å¯åŠ¨åç«¯ï¼ŒNginxæ‰˜ç®¡å‰ç«¯

### Dockeréƒ¨ç½² (æ¨è)
```dockerfile
# åç«¯Dockerfile
FROM openjdk:17-jdk-slim
COPY target/*.jar app.jar
ENTRYPOINT ["java","-jar","/app.jar"]
```

## å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ
- éµå¾ªSpring Bootæœ€ä½³å®è·µ
- ä½¿ç”¨Lombokç®€åŒ–ä»£ç 
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†
- RESTful APIè®¾è®¡åŸåˆ™

### å‰ç«¯è§„èŒƒ
- Vue 3 Composition API
- TypeScriptä¸¥æ ¼æ¨¡å¼
- Element Plusç»„ä»¶è§„èŒƒ
- å“åº”å¼è®¾è®¡åŸåˆ™

## ç›‘æ§ä¸ç»´æŠ¤

### æ—¥å¿—é…ç½®
- ä½¿ç”¨SLF4J + Logback
- åˆ†çº§æ—¥å¿—ç®¡ç†(DEBUG/INFO/WARN/ERROR)
- æ”¯æŒæ—¥å¿—æ–‡ä»¶æ»šåŠ¨

### æ€§èƒ½ç›‘æ§
- Spring Boot Actuatorç«¯ç‚¹
- æ•°æ®åº“è¿æ¥æ± ç›‘æ§
- AI APIè°ƒç”¨ç»Ÿè®¡

## å®‰å…¨è€ƒè™‘

### æ•°æ®å®‰å…¨
- æ•°æ®åº“è¿æ¥åŠ å¯†
- APIå¯†é’¥ç¯å¢ƒå˜é‡å­˜å‚¨
- ç”¨æˆ·è¾“å…¥éªŒè¯å’Œè¿‡æ»¤

### è®¿é—®æ§åˆ¶
- CORSè·¨åŸŸé…ç½®
- SQLæ³¨å…¥é˜²æŠ¤
- XSSæ”»å‡»é˜²æŠ¤

## æ‰©å±•åŠŸèƒ½

### è®¡åˆ’ä¸­çš„åŠŸèƒ½
- å¤šè¯­è¨€æ”¯æŒ
- è¯­éŸ³å¯¹è¯é›†æˆ
- æ›´ä¸°å¯Œçš„æ•°æ®åˆ†æ
- ç§»åŠ¨ç«¯é€‚é…
- ç¬¬ä¸‰æ–¹ç³»ç»Ÿé›†æˆ

## æ”¯æŒä¸è”ç³»

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤Issue
- å‘é€é‚®ä»¶è‡³é¡¹ç›®ç»´æŠ¤è€…
- æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£å’ŒWiki

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦è§LICENSEæ–‡ä»¶ã€‚